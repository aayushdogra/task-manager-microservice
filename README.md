# Task Manager Microservice (Minimal API â€” .NET 10)

A production-style **Task Manager microservice** built using **.NET 10 Minimal APIs**, PostgreSQL, and EF Core.  
The project demonstrates clean architecture, endpoint grouping, DTO-based API contracts, service-layer abstraction, and container-ready development workflows.

This service exposes REST APIs for:

- Creating tasks
- Fetching tasks
- Updating tasks
- Deleting tasks
- Health monitoring (`/health`, `/db-health`)

---

## ğŸš€ Features

### âœ” Minimal API (no controllers)

Lightweight, fast, and clean endpoint definitions using .NET 10 Minimal API style.

### âœ” Organized folder structure

- `/Models` â€” database entities  
- `/Dto` â€” request/response objects used by API  
- `/Services` â€” business logic + abstractions  
- `/Endpoints` â€” endpoint mappings grouped by domain  
- `/Data` â€” EF Core DbContext + SQL schema  

### âœ” DTO-based API contracts

All endpoints use **CreateTaskRequest**, **UpdateTaskRequest**, and **TaskResponse**  
for clean separation between database models and public API responses.

### âœ” PostgreSQL-backed persistence (EF Core)

- Real database CRUD implemented in `DbTaskService`  
- Fully persistent task creation, updates, and deletions  
- InMemoryTaskService removed from DI (can be used for tests only)

### âœ” Health monitoring

- `/health` â€” service health  
- `/db-health` â€” PostgreSQL connectivity  
- `/db-tasks-count` â€” useful for debugging DB reads/writes 

### âœ” Full Task CRUD (Completed)

- `GET /tasks`
- `GET /tasks/{id}`
- `POST /tasks`
- `PUT /tasks/{id}`
- `DELETE /tasks/{id}`

### âœ” Docker-ready project (database)

- Includes `docker-compose.yml` for running PostgreSQL locally  
- API Dockerfile planned next

### âœ” Structured Logging (Serilog)

- Centralized logging using Serilog  
- Console + rolling file logs (`logs/log-*.txt`)  
- Supports production overrides and environment-based logging levels  

### âœ” Global Exception Handling

- Automatic 500 error handling  
- Logs all unhandled exceptions with stack traces  
- Returns clean JSON error responses

---

## ğŸ³ Docker (PostgreSQL)

To start the PostgreSQL database locally:

```bash
docker compose up -d 
```
This launches a `tasks_db` PostgreSQL instance with:

- Host: `localhost`
- Port: `5432`
- User: `postgres`
- Password: `postgres`
- Database: `tasks_db`

API connects to the DB via EF Core using the connection string in appsettings.json or environment variables.

---

## ğŸ“… Recent Milestones (Completed)
- Switched DI from `InMemoryTaskService` â†’ `DbTaskService`
- Implemented full CRUD in DbTaskService (Create / GetAll / GetById / Update / Delete)
- Added timestamps (CreatedAt, UpdatedAt)
- Rewrote `/tasks` endpoints to use DTOs
- Added proper TaskResponse mapping for all GET/POST/PUT routes
- Added Serilog structured logging (console + rolling file logs)
- Implemented global exception handling middleware
- Added configuration support via appsettings.json + appsettings.Development.json

---

## ğŸ“… Next Milestone (WIP)

- Add Application Dockerfile
- Add Redis caching layer
- Add pagination & filtering for `/tasks`
- Add FluentValidation for DTOs
- Add JWT authentication
- Add async processing via Kafka/RabbitMQ
- Add metrics + observability tooling

---

## ğŸ“ Project Structure

```txt

TaskManager/
â”œâ”€â”€ Program.cs
â”œâ”€â”€ appsettings.json
â”œâ”€â”€ appsettings.Development.json
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ TaskItem.cs
â”‚
â”œâ”€â”€ Dto/
â”‚   â”œâ”€â”€ CreateTaskRequest.cs
â”‚   â”œâ”€â”€ UpdateTaskRequest.cs
â”‚   â””â”€â”€ TaskResponse.cs
â”‚
â”œâ”€â”€ Endpoints/
â”‚   â”œâ”€â”€ TaskEndpoints.cs
â”‚   â”œâ”€â”€ HealthEndpoints.cs
â”‚   â””â”€â”€ DebugEndpoints.cs
â”‚
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ ITaskService.cs
â”‚   â”œâ”€â”€ DbTaskService.cs
â”‚   â””â”€â”€ InMemoryTaskService.cs   (optional/test only)
â”‚
â”œâ”€â”€ Data/
â”‚   â”œâ”€â”€ TasksDbContext.cs
â”‚   â””â”€â”€ TasksTable.sql
â”‚
â”œâ”€â”€ logs/                       (auto-generated by Serilog)
â”‚   â””â”€â”€ log-20231208.txt        (rolling log files, one per day)
â”‚
â”œâ”€â”€ docker-compose.yml          (PostgreSQL container)
â”œâ”€â”€ TaskManager.csproj
â””â”€â”€ README.md

```
---

## âš™ï¸ Configuration (appsettings.json)

The microservice uses **appsettings.json** for environment-based configuration.

### Example:

```json
{
  "ConnectionStrings": {
    "TasksDb": "Host=localhost;Port=5432;Database=tasks_db;Username=postgres;Password=postgres"
  },
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "logs/log-.txt",
          "rollingInterval": "Day"
        }
      }
    ]
  }
}
